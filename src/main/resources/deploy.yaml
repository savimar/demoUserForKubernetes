apiVersion: apps/v1
kind: Deployment
metadata:
    name: savimar-deployment
spec:
    replicas: 3
    strategy:
      type: Recreate
    selector:
       matchLabels:
          app: savimar-demo
    template:
       metadata:
          labels:
             app: savimar-demo
       spec:
#         initContainers:
#          - name: check-db-ready
#            image: postgres:13.1-alpine
#            command:
#             - sh
#             - "-c"
#             - |
#               until pg_isready -h postrgres  -p  5432;
#               do echo waiting for database; sleep 2; done;
         containers:
          - name: savimar-demo
            image: savimar/forkube:forkube
            imagePullPolicy: Always
            ports:
              - name: web 
                containerPort: 9090
            livenessProbe:
             tcpSocket:
              port: 9090
             initialDelaySeconds: 100
             periodSeconds: 30
            readinessProbe:
             tcpSocket:
              port: 9090
             initialDelaySeconds: 100
             periodSeconds: 30
             
             
             
            